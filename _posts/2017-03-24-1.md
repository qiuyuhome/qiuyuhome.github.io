---
layout: post
title: SSH, SSL, CA, 密钥交换
categories: 计算机原理
description: 密钥交换
keywords: IKE, 密钥交换, SSH, SSL, CA
---

一直都想弄清楚密钥的作用是什么? 是怎么实现的. 特意简单的学习了一下密钥交换的原理. 记录如下:

## 小邱和小李想要在网络上传输数据. 

**邱----->李**

最简单的就是直接传送数据, 就是想要传输的数据, 都是**明文**(plaintext)的. 很多的协议都是明文的. 如:`telnet`, `ftp`, `http` 等等. 

但是这样传输数据的风险非常大, 比如, 有另外一个人, 能够截取到发送的数据, 这样的人称谓**中间人**(Man-in-the-middle), 他的这种行为就是**中间人攻击**(Man-in-the-middle attack，缩写：MITM).

专业点的话来说, 中间人攻击是指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方直接对话，但事实上整个会话都被攻击者完全控制。

邱----(中间人)--->李

所以, 不管中间人利用多么简单的技术或者多么复杂的技术, 只要他是冒充通讯双方的终端进行通讯截取, 都是中间人攻击. 包括明文数据的截取和公钥的截取等等. 

我以前一直搞不明白, 因为网上查资料, 有的举的例子是用明文说明的, 有的是用截取公钥的例子说明的. 其实他们都是中间人攻击. 



既然明文不行, 太不安全, 那么就用加密传输, 但是也有问题. 

加解密的具体运作由两部分决定：一个是算法，另一个是密钥。密钥是一个用于加解密算法的秘密参数，通常只有通信者拥有.
所以: **加解密 = 算法(algorithm) + 密钥(secret key)**

如: 小邱要传数据给小李, 小邱需要先加密数据, 小李收到数据后, 需要解密数据. 那么, 如果小邱是第一次和小李在网络上联络, 怎么确定用什么算法呢? 用什么密钥呢? 这个也是需要数据传输来告诉小李, 如果有中间人, 还是可以截取到的, 中间人知道了加解密的算法和密钥后, 跟明文有什么区别? 

算法是有限的, 密钥是无限的. 因此, 密钥就是重中之重. 所以就出现了**密钥交换**.

密钥交换, 用大白话解释, 就是怎么确保双方在交换密钥的时候, 别人知道了交换的信息, 也不知道我要表达的意思. 例如: 有默契的2个人之间, 一个眼神对方就明白什么意思了. 但是别人却不知道. 就是要达到这种效果. 

最著名的密钥交换, 是diffie和hellman这2个人发明的. 被称为**diffie-hellman协议**. 

**迪菲-赫尔曼密钥交换**（英语：Diffie–Hellman key exchange，缩写为D-H） 是一种安全协议。它可以让双方在完全没有对方任何预先信息的条件下通过不安全信道创建起一个密钥。这个密钥可以在后续的通讯中作为对称密钥来加密通讯内容。公钥交换的概念最早由瑞夫·墨克（Ralph C. Merkle）提出，而这个密钥交换方法，由惠特菲尔德·迪菲（Bailey Whitfield Diffie）和马丁·赫尔曼（Martin Edward Hellman）在1976年首次发表。马丁·赫尔曼曾主张这个密钥交换方法，应被称为迪菲-赫尔曼-墨克密钥交换（英语：Diffie–Hellman–Merkle key exchange）。

![](/images/posts/14903657782556.jpg)

![](/images/posts/14903660760754.jpg)

如果 p 是一个至少 300 位的质数，并且a和b至少有100位长， 那么即使使用全人类所有的计算资源和当今最好的算法也不可能从g, p和g^a mod p 中计算出 a。这个问题就是著名的**离散对数**问题。




